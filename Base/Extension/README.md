一、PHP 扩展包开发
=================
LX2 PHP 扩展包实战教程 - 从入门到发布 https://learnku.com/courses/creating-package  


二、异常抛出原则
===============

什么时候应该抛出异常？
---------------------

按照单一职责原则，一个类只应该关心自己的逻辑，当出现问题的时候，如果不是当前类该处理的，我们就应该抛出而不是消化。怎么理解呢？比如，请求天气接口的时候，网络出现问题，Guzzle 抛出了异常，这时候应该抛出异常。可是为啥不是 catch 异常然后返回 false 呢？这就涉及到边界问题了，业务异常与运行时异常 要区分开，对方接口说你要查询的城市不存在，返回错误，这属于业务异常，这时候是不会抛出异常的。而你请求的 API 不存在，或者对方服务器宕机，或者你的服务器网络出问题，这属于运行时异常，就应该以异常抛出来告知调用方，而不是自主处理该异常并返回 false 来结束逻辑。


异常的分类与命名
---------------

异常通常分为几个种类，按名称来命名：

- 参数错误，当传入的参数不合法时，我们通常抛出异常；
- HTTP 异常，在请求 API 时异常终止时抛出的异常；
- 其它异常，模块其它部分异常。

当然还有其它的，你可以命名非常细，比如 InvalidGatewayNameException、ErrorResponseException 等等，你可以自由发挥，只要做到合理命名即可。


三、PHPUnit测试用例编写
======================

测试类命名规范
-------------

测试用例与类名对应，以 Test.php 结尾，比如 WeatherTest.php，类名与文件名一致；      
测试用例需要继承 PHPUnit\Framework\TestCase 基类；      
测试用例的目录结构与源码一致；      
测试用例的方法名格式为 test源方法名，比如：testGetWeather。     

单元测试就是针对目标方法行为进行断言，所以只要在测试用例中将以上逻辑测试即可，并且提供反向测试。        


单元测试的测试替身
-----------------

运行单元测试的环境不一定具有生产环境的系统组件，比如在我们的代码持续集成系统中，通常只有代码与基本的构建环境。为了在测试环境中能保证测试的正常运行，我们需要对环境依赖使用替身来代替，以达到稳定测试效果，所以我们在测试时，网络请求组件是需要使用模拟对象（替身）来代替的，并不会真正的去请求 API。

如果在编写测试时无法使用（或选择不使用）实际的依赖组件（DOC），可以用测试替身来代替。测试替身不需要和真正的依赖组件有完全一样的的行为方式；他只需要提供和真正的组件同样的 API 即可，这样被测系统就会以为它是真正的组件！


四、扩展包文档
=============

一个优秀的扩展包应该包含友好的说明文档，所以发布前我们先来完善说明文档，开源项目一般是在项目根目录创建 README.md 作为使用文档，当然，如果你的项目过于复杂，那么你可能需要将文档放到项目 docs 文件夹下，我们这里主要介绍普通复杂度的扩展包文档的编写。

* 项目简介及创作动机
* 项目维护、CI、依赖更新状态（如果有）
* features & 适用人群
* 运行的平台或硬件要求
* 重要依赖
* 如何安装与测试
* 使用示例及文档地址
* 贡献指南
* License
* 鸣谢
* 其它特有的信息